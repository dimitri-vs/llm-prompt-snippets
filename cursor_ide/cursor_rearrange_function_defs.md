<!-- Original FlashPaste name: Cursor: Rearrange Function Defs -->
<!-- FlashPaste ID: 172 -->

Organize these function definitions into a logical order to improve code readability and maintainability. Organize from high-level to low-level, with the main entry points at the top, followed by major workflow functions, and then utility functions.

You don't need to give me the function content, in its place you can put `// ... existing code ...`